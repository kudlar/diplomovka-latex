%%
\section{Funkcia programu}

Program JXColl (Java XML Collector) slú¾i na zachytávanie a~predspracovávanie informácii
o~tokoch v~sie»ach získané exportérom. Je súèas»ou meracej architektúry BasicMeter, ktorý
na základe nastavených parametrov konfiguraèného súboru vie dané údaje uklada» do~databázy
alebo ich sprístupni» pomocou vlastného protokolu pre priame spracovanie (protokol ACP) pou¾ívateµovi.
Údaje ulo¾ené v~databáze slú¾ia pre neskor¹ie vyhodnotenie prídavnými modulmi spomínanej 
meracej architektúry a~sú v~súlade s~po¾iadavkami protokolu IPFIX. 
JXColl tie¾ generuje úètovacie záznamy, ktoré slú¾ia na analýzu pou¾ívania siete konkrétnym
pou¾ívateµom z~hµadiska IP adries, protokolov, portov a~èasových charakteristík. Program bol
vytvorený ¥ubo¹om Ko¹èom, neskôr zoptimalizovaný a~doplnený novými funkciami Michalom Ka¹èákom, Adriánom Pekárom a~Tomá¹om Vere¹èákom.

\newpage
\section{S\'upis obsahu dod\'avky}

Program je dodávaný na jednom in¹talaènom CD médiu (Príloha C - CD), ktoré obsahuje nasledujúce súèasti:

\begin{itemize}
 \item zdrojové súbory programu
 \item samostatne spustiteµné binárne súbory
 \item kni¾nice potrebné pre funkènos» programu
 \item DEB in¹talaèný balík
 \item dokumentáciu zlo¾enú z:
	\subitem diplomovej práce (PDF,  \LaTeX)
	\subitem systémovej príruèky (PDF, \LaTeX)
	\subitem tejto pou¾ívateµskej príruèky (PDF, \LaTeX)
	\subitem systémovej dokumentácie tried - javadoc vo formáte HTML
	\subitem databázového skriptu na vytvorenie tabuliek v~databáze (SH, SQL)
\end{itemize}

\newpage
\section{In\v{s}tal\'acia programu}

\subsection{Po\v{z}iadavky na technick\'e prostriedky}

Spoµahlivý beh samotného programu si vy¾aduje nasledovnú hardvérovú konfiguráciu:
\begin{itemize}
  \item CPU Intel Pentium III 1Ghz alebo ekvivalent
  \item operaèná pamä» 512MB 
  \item pevný disk s~1GB a viac voµného miesta 
  \item grafická karta novej generácie s~minimálne 64MB pamä»ou
  \item sie»ová karta 100Mbit/s 
\end{itemize}
Program pre spoµahlivý beh vy¾aduje minimálne 120MB voµnej pamäte RAM (pri pou¾ití ACP prenosu alebo pripojení TCP a SCTP aj viac, podµa poètu priamych pripojení). Nain¹talovaný program zaberá pribli¾ne 2.4MB na pevnom disku. % overit
Uvedené voµné miesto na pevnom disku je potrebné, ak sú dáta pomocou JXColl exportované na lokálnu databázu. Je potrebné si uvedomi», ¾e JXColl daemon loguje do /var/log/jxcoll/ a pri nastavenej úrovni logovania DEBUG, mô¾u logovacie súbory ma» znaènú veµkos». Pri dosiahnutí veµkosti 100MB sa obsah log súboru zálohuje a skomprimuje. Archivuje sa posledných 10 rotácií (1GB log výstupu).
Monitorovanie rozsiahlej¹ej siete (napr. sie» poskytovateµa komunikaèných slu¾ieb) si vy¾aduje podstatne vy¹¹ie hardvérové nároky.

\subsection{Po\v{z}iadavky na programov\'e prostriedky}
\begin{itemize}
\item operaèný systém GNU/Linux s~verziou jadra 2.6 a vy¹¹ou (odporúèa sa kvôli podpore SCTP)
\item Java Runtime Environment (JRE) verzie 1.7.0\_03 a~vy¹¹ej
\item balík lksctp-tools
\item kni¾nice dodávané na in¹talaènom médiu
\item vytvorená databáza s~tabuµkami podµa databázového skriptu dodávaného na in¹talaènom médiu
\end{itemize}

\subsection{Vlastn\'a in\v{s}tal\'acia}

Vlastná in¹talácia sa skladá z~in¹talácie DEB balíka v~prostredí operaèného systému Ubuntu alebo Debian. 
V~prostredí iného operaèného systému in¹talácia pozostáva z~nakopírovania spustiteµného Java archívu (\texttt{jxcoll.jar}) do~prieèinka podµa
vlastnej voµby spoloène s~adresárom kni¾níc. Následne treba do tohto prieèinka nakopírova» súbor popisujúci podporované informaèné elementy protokolu IPFIX programom JXColl (\texttt{ipfixFields.xml}) a uká¾kový konfiguraèný súbor (\texttt{jxcoll\_config.xml}), ktorý je potrebné upravi» pre vlastné prostredie meraní. 

\subsubsection{In\v{s}tal\'acia PostgreSQL a Java 7 pod Ubuntu 10.04 LTS}

\texttt{sudo apt-get install python-software-properties }\\
\texttt{sudo add-apt-repository ppa:pitti/postgresql}\\
\texttt{sudo add-apt-repository ppa:webupd8team/java}\\
\texttt{sudo apt-get update}\\
\texttt{sudo apt-get install postgresql-9.0 libpq-dev postgresql-contrib-9.0} \\
\texttt{sudo apt-get install oracle-jdk7-installer lksctp-tools}


\subsubsection{In\v{s}tal\'acia PostgreSQL a Java 7 pod Ubuntu 10.10 a\v{z} 11.04}

\texttt{sudo apt-get install python-software-properties }\\
\texttt{sudo add-apt-repository ppa:pitti/postgresql}\\
\texttt{sudo add-apt-repository ppa:openjdk/ppa}\\
\texttt{sudo apt-get update}\\
\texttt{sudo apt-get install postgresql-9.0 libpq-dev postgresql-contrib-9.0} \\
\texttt{sudo apt-get install openjdk-7-jre-headless lksctp-tools}

\subsubsection{In\v{s}tal\'acia PostgreSQL a Java 7 pod Ubuntu 11.10}

\texttt{sudo apt-get update}\\
\texttt{sudo apt-get install postgresql-9.1 libpq-dev postgresql-contrib-9.1} \\
\texttt{sudo apt-get install openjdk-7-jre-headless lksctp-tools}

\subsubsection{In\v{s}tal\'acia samotn\'eho JXColl}

Najprv sa treba pripoji» na databázový server ako pou¾ívateµ postgres a nastavi» µubovoµné heslo:

\texttt{sudo -u postgres psql} \\
\texttt{ALTER USER postgres WITH ENCRYPTED PASSWORD 'password';} \\

Keï je to potrebné, tak nastavi» privilégiá v~súbore:\\
\texttt{/etc/postgresql/9.0/main/pg\_hba.conf}
 
Na úvod sekcie \texttt{ipv4} je potrebné prida» riadok, kde sa v~poli \texttt{IP\_ADDRESSES} uvedú adresy alebo rozsah adries, z~ktorých sa na databázu pripájajú kolektor a analyzéry.

\texttt{host   bmdb,bmdwh 	  bm,bmro  IP\_ADDRESSES   md5 }\\

Nakonfigurujú sa rozhrania, na ktorých má databázový server poèúva» na prichádzajúce pripojenia v~súbore \texttt{/etc/postgresql/9.0/main/postgresql.conf}. Predvolené nastavenie je \texttt{localhost}. Treba zada» adresy rozhraní 
oddelené èiarkou, alebo zada» '*', èo povolí pripojenie odkiaµkoµvek.

Ïa¹í krok je stiahnutie in¹talaèného DEB balíka zo SVN repozitára:

\texttt{wget https://svn.cnl.tuke.sk/monica/BasicMeter/Collector/jxcoll/ \\ deb/jxcoll\_3.9\_i386.deb --no-check-certificate }

Spusti» stiahnutý DEB balík pomocou príkazu

\texttt{sudo dpkg -i jxcoll\_3.9\_i386.deb }

Po in¹talácii je nutné vytvori» databázovú ¹truktúru nástroja JXColl spustením nasledujúceho skriptu:

\texttt{sh /usr/lib/jxcoll/bmdbScripts/bmdbScript.sh }

Posledným krokom je nastavenie konfiguraèného súboru \texttt{/etc/jxcoll/jxcoll\_config.xml}. Najdôle¾itej¹ie je nastavi»
parametre databázového pripojenia a aktiváciu po¾adovaných transportných protokolov.


\subsection{Skript na vytvorenie tabuliek}

Na konci in¹talácie programu prostredníctvom DEB balíka, je pou¾ívateµ vyzvaný na mo¾nos» vytvorenia databázovej ¹truktúry s~prednastavenými hodnotami pomocou skriptu. Táto mo¾nos» poskytuje pohodlnú konfiguráciu databázy PostgreSQL bez dôkladnej znalosti jej samotnej a jej jazyka PL/pgSQL. Vytvorenie ¹truktúry je vykonaná pomocou BASH in¹talaèného skriptu a databázových skriptov, ktorých popis je nasledovný:

\begin{itemize}
\item \textbf{bmdbScript.sh} - hlavný BASH skript, z~ktorého sa volajú databázové skripty. Je interaktívny, teda si od pou¾ívateµa vy¾aduje rôzne informácie a zároveò kontroluje úspe¹né vykonanie jednotlivých èastí procesu vytvorenia databázovej ¹truktúry.
\item \textbf{RolesAndDB.sql} - je zodpovedný za vytvorenie databáz a rolí. Zmenou jednotlivých polí skriptu si pou¾ívateµ mô¾e µubovolne nastavi» názvy databáz a prihlasovacích údajov.
\item \textbf{SchemPrivTab.sql} - obsahuje príkazy na vytvorenie databázovej schémy, nastavenie práv pre pou¾ívateµov databázy a vytvorenie tabuliek pre jednotlivé informaèné elementy. Podobne ako v~predo¹lom prípade, pou¾ívateµ mô¾e upravi» skript podµa vlastnej voµby.
\item \textbf{dbLink.sql} - zabezpeèuje funkcie potrebné na vytvorenie spojenia medzi databázami.
\item \textbf{dbFunctTrig.sql} - vytvára funkciu a spú¹»aè, ktoré vykonávajú pred-spracovávanie údajov, v~dôsledku ktorého sa k~nim zabezpeèí efektívnej¹í prístup z~analyzujúcich aplikácií.
\item \textbf{dwh.sql} - vytvára tabuµky pre predspracované údaje analyzujúcej aplikácie.
\end{itemize} 

Tieto súbory in¹talátor DEB balíka umiestni v~nasledujúcom prieèinku: 

\begin{center}
\texttt{/usr/lib/jxcoll/bmdbScripts/ }
\end{center}

In¹talaèný skript sa spú¹»a príkazom: 
\begin{center}
\texttt{sh /usr/lib/jxcoll/bmdbScripts/bmdbScript.sh }
\end{center}

Samozrejme, pou¾ívateµ si mô¾e prispôsobi» ka¾dý z~vy¹¹ie uvedených súborov podµa vlastnej potreby. Eventuálne, mô¾e aj vynecha» niektoré postupy vytvárania ¹truktúry. Ka¾dá si z~týchto mo¾ností si u¾ v¹ak vy¾aduje dôkladnej¹iu znalos» zhroma¾ïovacieho procesu a spôsobu exportovania údajov do databázy.

\newpage
\section{Pou\v{z}itie programu}

JXColl je konzolová aplikácia. 
V~prípade in¹talácie programu pomocou DEB in¹talaèného balíka, JXColl sa spú¹»a na pozadí automaticky pri ¹tarte systému ako daemon. 
JXColl daemon (jxcolld) je mo¾né ovláda» nasledovným príkazom:

\begin{center}
\texttt{sudo /etc/init.d/jxcolld $<$operacia$>$} \hspace{10mm},
\end{center}
kde \texttt{operacia} treba zameni» za jedno z~nasledovného :
\begin{itemize}
 \item \textbf{start} spustí JXColl daemon, ak e¹te nebe¾í,
 \item \textbf{stop} zastaví èinnos» JXColl daemon-a,
 \item \textbf{restart} zastaví a znovu spustí JXColl daemon-a,
 \item \textbf{status} zistí èi JXColl daemon be¾í alebo nie,
 \item \textbf{usage / help} zobrazí informácie o~ovládaní JXColl daemon-a.
\end{itemize}
Hneï po in¹talácii nie je JXColl daemon spustený a~v~tomto prípade je potrebné buï re¹tartova» poèítaè, alebo pou¾i» vy¹¹ie uvedený init.d skript.
Výstup JXColl daemon-a sa dá prezrie» v~súbore 

\begin{center}
\texttt{/var/log/jxcoll/YYYYMMDD-HHmmss/jxcoll.log } ,
\end{center}

kde Y-rok, M-mesiac, D-deò, H-hodina, m-minúta, s-sekunda spustenej in¹tancie JXColl daemon-a.

\noindent Spustenie programu na operaèných systémoch Ubuntu/Debian pri in¹talácii pomocou DEB balíka je nasledovné:

\begin{center}
\texttt{jxcoll [--logtofile]}\\
\end{center}

Ak zadáme nepovinný argument \texttt{--logtofile}, výstup programu bude presmerovaný do log súboru popísaného vy¹¹ie. Ak pou¾ívateµ nie je root, je potrebné ma» v~systéme pridelené sudo právo a JXColl spusti» príkazom:

\begin{center}
\texttt{sudo jxcoll [--logtofile]}\\
\end{center}

Tak ako väè¹ina aplikácií v~prostredí operaèného systému Linux, aj JXColl má k~dispozícii manuálové stránky (man), ktoré je mo¾né zobrazi» pomocou príkazov:

\begin{center}
\texttt{man jxcoll}\\
\end{center}

\begin{center}
\texttt{man jxcoll\_config}\\
\end{center}

V~prostredí iného operaèného systému ako Ubuntu/Debian, alebo pri potrebe manuálneho spustenia, JXColl sa spú¹»a pomocou Java interpretéra s~voliteµným parametrom pozostávajúcim z~cesty (relatívnej alebo absolútnej) ku konfiguraènému súboru:

\begin{center}
\texttt{java -jar jxcoll.jar [/cesta/ku/konfiguraènému/súboru/jxcoll\_config.xml] [--logtofile]}\\
\end{center}

Ak sa nezadá cesta ku konfiguraènému súboru, aplikácia k~nemu automaticky oèakáva túto cestu:\texttt{/etc/jxcoll/jxcoll\_config.xml}. Ak konfiguraèný
súbor nie je nájdený, aplikácia skonèí s~chybovým hlásením. 

\noindent Spustenie programu na iných Linux-ových distribúciách je nasledovné:

\begin{center}
\texttt{java -jar jxcoll.jar [/cesta/ku/konfiguraènému/súboru/jxcoll\_config.xml]}\\
\end{center}

Ïal¹ou podmienkou spustenia JXColl je súbor ipfixFields.xml. Cesta k~tomuto súboru sa nastavuje v~konfiguraènom súbore \texttt{jxcoll\_config.xml}.
Ak pri spustení JXColl sa súbor ipfixFields nenachádza v~adresári definovanom v~konfiguraènom súbore, aplikácia skonèí s~chybovým hlásením. 
V~prípade absencie riadku s~cestou k~ipfixFields.xml v~konfiguraènom súbore, JXColl automaticky predpokladá túto cestu: \texttt{/etc/jxcoll/jxcoll\_config.xml}. 
Ak sa ani tu XML súbor nenachádza, JXColl ukonèí svoju èinnos». Bez tohto súboru nie je mo¾né rozpozna» údaje z~prijatých IPFIX paketov.

\noindent Ak chceme program spú¹»a» zo zdrojových súborov, je potrebná znalos»
nastavovania ciest ku triedam pre Javu, eventuálne vedie» kompilova» zdrojové súbory
v~Jave.

\subsection{Popis dial\'ogu s~pou\v{z}\'ivate\v{l}om}

Ked¾e program je konzolová aplikácia, neposkytuje ¾iadne grafické zobrazenie dialógu pre pou¾ívatela. Chybové a informacné hlásenia sú zobrazované v~rovnakej konzole v~ktorej bol program spustený, prípadne v~log súbore ak bol program spustený s~voliteµným argumentom.

Ukonèenie programu sa vykoná stlaèením kombinácie kláves CTRL + C alebo poslaním signálu SIGTERM alebo SIGINT konkrétnemu procesu:

\begin{center}
\texttt{kill -SIGTERM pid\_procesu\_jxcoll }\\
\end{center}

Na operaèných systémoch Ubuntu/Debian pri nain¹talovanom DEB balíku je mo¾né ukonèenie JXColl daemon-a pomocou init.d skriptu (viï. vy¹¹ie).

\subsection{Popis konfigura\v{c}n\'eho s\'uboru}

Konfiguraèný súbor je odovzdávaný ako parameter príkazového riadku. Jednotlivé konfiguraèné parametre sa triedia podµa typu modulov, ktorých sa nastavenia týkajú. Tieto typy ako aj zoznam v¹etkých mo¾ných parametrov, ich popis, ¹tandardné hodnoty a mo¾né voµby sa nachádzajú v~tabuµkách \ref{tbl:conf1}, \ref{tbl:conf2}, \ref{tbl:conf3} a \ref{tbl:conf4}. V~prípade, ¾e daná hodnota pre akýkoµvek parameter nie je uvedená v~konfiguraènom súbore, parameter sa nastaví na ¹tandardnú hodnotu. Uká¾kový konfiguraèný súbor na in¹talaènom médiu obsahuje pribli¾né popisy parametrov a ich ¹tandardné hodnoty. Parameter sa zapisuje vo formáte: 

\begin{center}
\texttt{$<$meno\_parametra$>$hodnota$<$/meno\_parametra$>$ }\\
\end{center}

Konfiguraèný súbor mô¾e obsahova» komentár, ktorý musí by» ohranièený znakmi: 

\begin{center}
\texttt{$<$!-- komentár --$>$ }\\
\end{center}

Keï¾e heslá sú zadávané ako èistý text,
je na u¾ívateµovi aby konfiguraènému súboru nastavil také práva, aby sa heslo dalo èíta» iba
u¾ívateµom, ktorí mô¾u spú¹»a» program.


\begin{sidewaystable}[ht]
\tabcolsep=4pt 
\caption{Voµby konfiguraèného súboru 1}
\renewcommand{\arraystretch}{0.3}
\begin{center}
  \begin{tabular}{|p{4.1cm}|p{2.6cm}|p{7.4cm}|p{7.5cm}|}
% {|p{2cm}|p{1.7cm}|p{4cm}|p{4cm}|}
    \hline
    \textbf{Parameter} & \textbf{¹tandardná hodnota}  & \textbf{Prípustné hodnoty}  & \textbf{Popis}\\
    \hline
 \multicolumn{4}{|c|}{\textbf{Modul:} V¹eobecné nastavenia celého programu (global)} \\
    \hline
    logLevel & ERROR & ALL, DEBUG, INFO, WARN, TRACE, ERROR, FATAL, OFF & úroveò logovania programu\\
    \hline
    ipfixFieldsXML & /etc/jxcoll/\newline ipfixFields.xml & platná cesta v~rámci súborového systému & cesta k~XML súboru popisujúceho IPFIX informaèné elementy\\
    \hline
    ipfixTemplateTimeout & 300 & prirodzené celé èíslo väè¹ie ako 0 & èas, po ktorom sa èablóna pre IPFIX paket pova¾uje za neplatnú\\
    \hline   
    listenPort & 4739 &  prir. èíslo z~intervalu $<$0-65535$>$  (kt. nie je obsadené) & port, na ktorom be¾í vlákno èítajúce dáta zo siete\\
    \hline 
    receiveUDP  & yes & yes, no & príjem pomocou transportného protokolu UDP\\
    \hline
    receiveTCP  & yes & yes, no & príjem pomocou transportného protokolu TCP\\
    \hline
    receiveSCTP  & yes & yes, no & príjem pomocou transportného protokolu SCTP\\
    \hline
    maxConnections  & 10 & prir. èíslo & maximálny poèet spojení pre protokoly TCP a SCTP\\
    \hline

    \multicolumn{4}{|c|}{\textbf{Modul:} Modul pre synchronizáciu meracích bodov (sync)} \\
    \hline

    makeSync & no & yes, no & príznak, èi sa kolektor správa ako synchronizaèný server voèi meracím bodom\\
    \hline 
    listenSynchPort & 5544 & prir. èíslo z~intervalu $<$0-65535$>$  (kt. nie je obsadené) & port, na ktorom bude poèúva» synchronizaèný server\\
    \hline 

  \end{tabular}
  \label{tbl:conf1}
\end{center}
\end{sidewaystable}



\begin{sidewaystable}[ht]
\tabcolsep=4pt 
\caption{Voµby konfiguraèného súboru 2}
\renewcommand{\arraystretch}{0.3}
\begin{center}
  \begin{tabular}{|p{7cm}|p{2.3cm}|p{6.2cm}|p{6.2cm}|}
% {|p{2cm}|p{1.7cm}|p{4cm}|p{4cm}|}
    \hline
  \textbf{Parameter} & \textbf{?tandardná hodnota}  & \textbf{Prípustné hodnoty}  & \textbf{Popis}\\
\hline

	\multicolumn{4}{|c|}{\textbf{Modul:} Modul pre meranie jednosmerného oneskorenia (owd)} \\
    \hline
    measureOwd & no & yes , no & príznak, èi kolektor má mera» jednosmerné oneskorenie\\
    \hline
    
    owdStart\_ObservationPointTemplateID & 256 & identifikátor ¹ablóny, ktorý je v~súlade s~IPFIX ¹pecifikáciou & ident. ¹ablóny meracieho bodu, v~ktorom sa zaèína meranie owd\\
    \hline
owdStart\_ObservationDomainID & 0 & identifikátor domény, ktorý je v~súlade s~IPFIX ¹pecifikáciou & doména, v~ktorej sa merací bod nachádza\\
    \hline
    owdStart\_Host & 127.0.0.1 & názov alebo IP adresa v~správnom formáte & názov alebo IP adresa meracieho bodu\\
    \hline
    owdStart\_ObservationPointID & 123 & identifikátor meracieho bodu, ktorý je v~súlade s~IPFIX ¹pecifikáciou & ident. meracieho bodu, v~ktorom sa zaèína meranie owd\\
    \hline
 owdEnd\_ObservationPointTemplateID & 257 & identifikátor ¹ablóny, ktorý je v~súlade s~IPFIX ¹pecifikáciou & ident. ¹ablóny meracieho bodu, v~ktorom sa konèí meranie owd\\
    \hline
owdEnd\_ObservationDomainID & 0 & identifikátor domény, ktorý je v~súlade s~IPFIX ¹pecifikáciou & doména, v~ktorej sa merací bod nachádza\\
    \hline
    owdEnd\_Host & 127.0.0.1 & názov alebo IP adresa v~správnom formáte & názov alebo IP adresa meracieho bodu\\
    \hline
    owdEnd\_ObservationPointID & 321 & identifikátor meracieho bodu, ktorý je v~súlade s~IPFIX ¹pecifikáciou & ident. meracieho bodu, v~ktorom sa konèí meranie owd\\
    \hline
  \end{tabular}
  \label{tbl:conf2}
\end{center}
\end{sidewaystable}


\begin{sidewaystable}[ht]
\tabcolsep=4pt 
\caption{Voµby konfiguraèného súboru 3}
\renewcommand{\arraystretch}{0.3}
\begin{center}
  \begin{tabular}{|p{3cm}|p{2.3cm}|p{8cm}|p{8cm}|}
% {|p{2cm}|p{1.7cm}|p{4cm}|p{4cm}|}
    \hline

  \textbf{Parameter} & \textbf{\v{S}tandardná hodnota}  & \textbf{Prípustné hodnoty}  & \textbf{Popis}\\
    \hline
    passiveTimeout & 5000 & prirodzené celé èíslo väè¹ie ako 0 & passiveTimeout, ktorý je nastavený aj na meracích bodoch\\
    \hline
    activeTimeout & 10000 & prirodzené celé èíslo väè¹ie ako 0 & activeTimeout, ktorý je nastavený aj na meracích bodoch\\
    \hline 

   \multicolumn{4}{|c|}{\textbf{Modul:} Modul pre priame spracovanie údajov (acp)} \\
    \hline

    acpTransfer & no & yes, no & príznak, èi sa sa údaje posielajú pre priame spracovanie\\
    \hline
 
    acpPort & 2138 & prir. èíslo z~intervalu $<$0-65535$>$  (kt. nie je obsadené) & port, na ktorom be¾í slu¾ba pre priame pripojenie na JXColl\\
    \hline
    acpLogin & bm & re»azec & prihlasovacie meno pre priame pripojenie na JXColl\\
    \hline
    acpPassword & bm & re»azec & heslo pre priame pripojenie na JXColl\\
    \hline

    \multicolumn{4}{|c|}{\textbf{Modul:} Modul pre export údajov do databázy (database)} \\
    \hline
     
    dbExport & yes & yes, no & príznak, èi sa exportujú výsledky meraní do databázy PostgreSQL\\
    \hline
    dbHost & localhost & názov alebo IP adresa databázového servera & databázový server PostgreSQL\\
    \hline
    dbPort & 5432 & èíslo portu, na ktorom sa vieme pripoji» na danú databázu & port, na ktorom be¾í databázový server PostgreSQL\\
    \hline

    dbName & bmdb & re»azec udávajúci názov databázy & databáza pre ukladanie výsledkov meraní v~PostgreSQL\\
    \hline
    dbLogin & bm & re»azec udávajúci prihlasovacie meno & prihlasovacie meno do databázy PostgreSQL\\
    \hline
    dbPassword & bm & re»azec udávajúci heslo & heslo do databázy PostgreSQL\\
    \hline 
  \end{tabular}
  \label{tbl:conf3}
\end{center}
\end{sidewaystable}




\begin{sidewaystable}[ht]
\tabcolsep=4pt 
\caption{Voµby konfiguraèného súboru 4}
\renewcommand{\arraystretch}{0.3}
\begin{center}
  \begin{tabular}{|p{4.5cm}|p{2.3cm}|p{5cm}|p{9cm}|}
% {|p{2cm}|p{1.7cm}|p{4cm}|p{4cm}|}
    \hline

  \textbf{Parameter} & \textbf{\v{S}tandardná hodnota}  & \textbf{Prípustné hodnoty}  & \textbf{Popis}\\

\hline 

 \multicolumn{4}{|c|}{\textbf{Modul:} Modul pre úètovaciu aplikáciu (accounting)} \\
    \hline 
   
    AccExport & no & yes, no & príznak, èi sa exportujú výsledky meraní pre úètovanie do databázy PostgreSQL\\
    \hline
    AccRecordExportInterval & 60 & prirodzené celé èíslo väè¹ie ako 0 &  èas v~sekundách, po ktorom sa záznamy pre úètovanie majú ulo¾i» do databázy\\
    \hline
    AccUserID & 1 & prirodzené celé èíslo väè¹ie ako 0 & identifikátor pou¾ívateµa v~databáze, pre ktorého sa majú úètovacie záznamy uklada»\\
    \hline 
 \end{tabular}
  \label{tbl:conf4}
\end{center}
\end{sidewaystable}



\clearpage

\subsection{Popis spr\'av pre syst\'emov\'eho program\'atora}
V~dodanej verzii JXColl sa zmenil aj spôsob zobrazovania správ. Logovací subsystém v¹ak zostal nedotknutý. Správy oproti starej verzie programu sú teraz prehµadnej¹ie a krat¹ie.

Poèas behu programu sa vypisujú rôzne hlásenia od chybových a¾ po informaèné. Logovací
subsystém programu je mo¾né inicializova» rôznymi úrovòami. Ich popis je uvedený
v~tabuµke~\ref{tbl:log}. Ka¾dá úroveò zahàòa v~sebe aj úrovne na ni¾¹om stupni, tak¾e napr. pre úroveò
ERROR sa budú zobrazova» aj hlásenia typu FATAL. Na reálnu prevádzku je vhodné nastavi» úroveò ERROR.

\begin{table}[ht]
\tabcolsep=4pt  
\caption{Logovacie úrovne programu}
\begin{center}
  \begin{tabular}{|l|p{11cm}|}
    \hline
    \textbf{Typ hlásenia} & \textbf{Popis}\\
    \hline
    ALL & vypisuje sa v¹etko\\
    \hline
    DEBUG & zobrazujú sa kompletné výpisy celého diania v~programe\\
    \hline
    INFO  & program informuje o~svojej èinnosti a~akcii, INFO ktorú práve vykonáva\\
    \hline
    WARN  & vypí¹u sa informácie o~upozorneniach programu na mo¾né chyby alebo zlú interpretáciu vstupných dát\\
    \hline
    TRACE & zobrazia sa informácie o~stave programu\\
    \hline
    ERROR & sú vypísané hlásenia chýb majúcich vplyv na dáta\\
    \hline
    FATAL & hlásenia, ktoré sú pre beh programu smrteµné a~zvyèajne znamenajú nezotaviteµnú chybu programu\\
    \hline
    OFF & vypnú sa v¹etky hlásenia programu\\
    \hline
  \end{tabular}
 \end{center}

  \label{tbl:log}
\end{table}

\section{Obmedzenia programu}

Program sa bude na pomal¹ích poèítaèoch jednoznaène pomal¹ie spú¹»a», keï¾e Java je jazyk
interpretovaný a~be¾iaci vo vlastnom virtuálnom stroji. Rýchlos» programu tie¾ závisí na mno¾stve prijatých dát.
Ïal¹ie obmedzenie je dané schémou databázy, ktorá je vopred daná, a~pre jej zmenu je nutné zmeni» aj samotný zdrojový kód. 

\newpage
\section{Chybov\'e hl\'asenia}

Poèas pou¾ívania programu mô¾e dôjs» k~nasledujúcim chybám. Èasové známky boli odstránené kvôli zvý¹eniu prehµadnosti.

\noindent \textbf{Chyba:}
\begin{verbatim}
DEBUG [main] DBExport  - 
Connecting to postgres@jdbc:postgresql://127.0.0.3:5432/bm... 

ERROR [main] DBExport  - 
Connection refused. Check that the hostname and port are correct and
that the postmaster is accepting TCP/IP connections.

INFO [main] DBExport  - 
Login failed. org.postgresql.util.PSQLException: Connection refused. Check
that the hostname and port are correct and that
the postmaster is accepting TCP/IP connections. SQL error

INFO [main] DBExport  - 
Login failed. org.postgresql.util.PSQLException: FATAL: password authentication
failed for user "postgres" SQL error
\end{verbatim}
\textbf{Popis a~rie¹enie:}
V~týchto prípadoch sa JXColl nedoká¾e napoji» na databázu. Buï je zle zadaná adresa, port
servera, prihlasovacie údaje alebo je spojenie blokované/nefunkèné.\\

\noindent \textbf{Chyba:} 
\begin{verbatim}
INFO  [main] Config  - Loading config file: /zla/cesta/k/jxcoll_config.xml
ERROR [main] Config  - Could not load config file: /zla/cesta/k/jxcoll_config.xml !
\end{verbatim} 
\textbf{Popis a~rie¹enie:}
Nie je mo¾né naèíta» konfiguraèný súbor. Treba sa uisti», èi súbor /etc/jxcoll/jxcoll.conf existuje, alebo èi je k~nemu správne zadaná cesta.

\noindent \textbf{Chyba:}
\begin{verbatim}
FATAL [main] IpfixElements  - XML file "/etc/jxcoll/ipfixFields.xmla" 
	was not found!
FATAL [main] JXColl  - JXColl could not start because of an error while 
	processing XML file!
\end{verbatim}
\textbf{Popis a~rie¹enie:}
Nena¹iel sa ipfixFields.xml súbor, ktorý slú¾i na rozpoznanie údajov z~IPFIX paketu. 
Treba sa uisti», èi sa súbor nachádza v~prieèinku definovanom v~konfiguraènom súbore alebo v~predvolenej ceste (/etc/jxcoll/ipfixFields.xml).\\

\noindent \textbf{Chyba:}
\begin{verbatim}
ERROR [ACP Thread 4] ACPIPFIXWorker  - IO EXCEPTION :null
DEBUG [ACP Thread 4] ACPIPFIXWorker  - Closing connection in try-catch
\end{verbatim}
\textbf{Popis a~rie¹enie:}
V~tomto prípade modul, ktorý pou¾íva protokol ACP na priame sprístupnenie nameraných dát, neèakane preru¹il spojenie. JXColl sa automaticky zotaví
a~bude naïalej èaka» pripojenie cez protokol ACP.\\

\noindent \textbf{Chyba:}
\begin{verbatim}
ERROR [UDP Processor] DBExport  - Check if is DB connected failed:
java.lang.NullPointerException
\end{verbatim}
\textbf{Popis a~rie¹enie:}
Poèas spracovania údajov sa do¹lo k~preru¹ení spojenia s~databázou. Treba sa uisti», èi chyba nenastala v~spojení.\\

\noindent \textbf{Chyba:}
\begin{verbatim}
ERROR [Net Parser] RecordDispatcher  - Element with ID: 74 is not supported, 
	skipped! Update XML file!
\end{verbatim}
\textbf{Popis a~rie¹enie:}
Poèas spracovania údajov sa narazilo na nepodporovaný informaèný element. JXColl tento element preskoèí.
Treba aktualizova» XML súbor ipfixFields.xml o~informácie o~tomto elemente, prípadne doimplementova» jeho podporu v~JXColl.\\

\newpage
\noindent \textbf{Chyba:}
\begin{verbatim}
ERROR [UDP Processor] RecordDispatcher  - i.e. 'icmpTypeCodeIPv6' (unsigned16) - 
	received data has wrong datatype! (10 bytes)
ERROR [UDP Processor] RecordDispatcher  - Skipping this element DB exportation!

\end{verbatim}
\textbf{Popis a~rie¹enie:}
Poèas spracovania údajov sa narazilo na informaèný element, ktorého veµkos» nekore¹ponduje s~oèakávaným dátovým typom podµa XML súboru. 
JXColl tento element preskoèí. Nápravu je nutné vykona» pravdepodobne na strane exportéra.\\

\noindent \textbf{Chyba:}
\begin{verbatim}
ERROR [UDP Processor] RecordDispatcher  - "i.e. 'subTemplateMultiList' - 
	Cannot decode datatype: subTemplateMultiList
ERROR [UDP Processor] RecordDispatcher  - Skipping this element DB exportation!

\end{verbatim}
\textbf{Popis a~rie¹enie:}
Poèas spracovania údajov sa narazilo na informaèný element, ktorého dátový typ JXColl nevie dekódova». 
JXColl tento element preskoèí. Nápravu je nutné vykona» na strane JXColl.

\noindent \textbf{Chyba:}
\begin{verbatim}
ERROR [TCP Processor] IpfixParser  - Field data is longer than remaining bytes in Data Set!
ERROR [TCP Processor] IpfixParser  - Corrupted data detected! Shutting down TCP connection to IP:port

ERROR [TCP Processor] IpfixParser  - Template Set is not long enough to hold all field specifiers!
ERROR [TCP Processor] IpfixParser  - Corrupted data detected! Shutting down TCP connection to IP:port

ERROR [TCP Processor] IpfixParser  - Options Template has field count set to 0!
ERROR [TCP Processor] IpfixParser  - Corrupted data detected! Shutting down TCP connection to IP:port

ERROR [TCP Processor] IpfixParser  - Message length (20) is not as stated in header (630)!
ERROR [TCP Processor] IpfixParser  - Corrupted data detected! Shutting down TCP connection to IP:port

ERROR [TCP Processor] IpfixParser  - Set states that it is longer than remaining data part is!!
ERROR [TCP Processor] IpfixParser  - Corrupted data detected! Shutting down TCP connection to IP:port

\end{verbatim}
\textbf{Popis a~rie¹enie:}
Poèas príjmu údajov cez protokol TCP boli prijaté chybné dáta, spojenie sa uzatvára a vlákno konèí. Chyba bola spôsobená na strane exportéra
poslaním po¹kodených dát. Tieto chybové správy platia a majú rovnaký význam aj pre protokol SCTP. Chyba bola spôsobená exportérom.

\noindent \textbf{Chyba:}
\begin{verbatim}
ERROR [TCP Processor] IpfixParser  - Attempt to withdraw Template #267, OD:0, 
	which does not exist in cache!
ERROR [TCP Processor] IpfixParser  - Shutting down TCP connection to IP:port

\end{verbatim}
\textbf{Popis a~rie¹enie:}
Poèas príjmu údajov cez protokol TCP bola prijatá správa Template Withdrawal Message, ktorá ru¹í u¾ predtým zru¹enú alebo neexistujúcu ¹abl\'onu.
Správa sa zahodí, spojenie sa násilne uzavrie (RST) a vlákno konèí. Rovnaký význam platí aj pre protokol SCTP. Chyba bola spôsobená exportérom.

\noindent \textbf{Chyba:}
\begin{verbatim}
ERROR [TCP Processor] IpfixParser  - Template #267 is already in cache!
ERROR [TCP Processor] IpfixParser  - Shutting down TCP connection to IP:port

\end{verbatim}
\textbf{Popis a~rie¹enie:}
Ide o~pokus o~pridanie ¹abl\'ony do cache, ktorá tam u¾ existuje.
Správa sa zahodí, spojenie sa násilne uzavrie (RST) a vlákno konèí. Rovnaký význam platí aj pre protokol SCTP.
Chyba bola spôsobená exportérom.


\noindent \textbf{Chybové hlásenia súvisiace s~Java Virtual Machine (JVM)}\\
\noindent Program je interpretovaný v~Java Virtual Machine.
Chyby, ktoré mô¾u nasta» a~nie sú o¹etrené vlastnými chybovými hláseniami programu sú
chyby, ktoré boli nepredvídané a~sú µahko rozoznateµné tým, ¾e nie sú formátované v~¹týle
loggera a~zvyèajne sú oznaèené ako Java Error alebo Exception. Obyèajne sa vypí¹e aj èas»
zásobníka. Be¾ne sú to tri riadky v~hierarchii volania danej metódy, ktorá takto zlyhala.
Takéto chyby znamenajú po¹kodenie funkcie programu a~je nutné ho re¹tartova». Chybu je
mo¾né opravi» len v~zdrojovom kóde, teda sa berie ako programátorská chyba.\\

\noindent \textbf{Opis známych chýb}\\
\noindent V~súèasnosti neboli v~JXColl nájdené vá¾ne chyby.


\newpage
\section{Pr\'iklad pou\v{z}itia}

Program je mo¾né primárne pou¾i» v~spojení so zariadením alebo so softvérom, ktorý je schopný
exportova» informácie o~tokoch v~sieti vo formáte IPFIX. Takéto zariadenie mô¾e
by» napr. Cisco router schopný exportu IPFIX dát alebo z~modulov BasicMetra napríklad BEEM.
Analyzujúca aplikácia je primárne zastúpená BMAnalyzer-om, a~v~princípe mô¾e to by» softvér,
ktorý doká¾e spracováva» údaje získané buï prostredníctvom protokolu ACP, alebo z~databázy.
Po úprave vkladacieho SQL re»azca v~zdrojovom kóde je mo¾né JXColl prispôsobi»  aj k~schéme inej databázy.

\section{Zoznam pou\v{z}itej literat\'ury}

[1]  Ko¹èo, M.: Opis sie»ových protokolov prostredníctvom jazyka XML, 2005,
Diplomová práca, KPI FEI TU, Ko¹ice

[2]  Ka¹èák, M.: Príspevok k~problematike aplikaèného vyu¾itia meraní prevádzkových parametrov poèítaèových sietí, 2007,
Diplomová práca, KPI FEI TU, Ko¹ice

[3]  Pekár, A.: Meranie prevádzkových parametrov siete v~reálnom èase, 2009,
Bakalárska práca, KPI FEI TU, Ko¹ice

[3]  Vere¹èák, T.: Zhroma¾ïovací proces nástroja BasicMeter, 2010,
Bakalárska práca, KPI FEI TU, Ko¹ice

[4]  Pekár, A.: Optimalizácia zhroma¾ïovacieho procesu nástroja BasicMeter, 2011,
Diplomová práca, KPI FEI TU, Ko¹ice
